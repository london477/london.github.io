<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/1FLj8izC6-I4VXukH1OT-Y6Tntf_8g1U35lOJHYi1Lfs/gviz/tq?sheet=Sayfa1&tqx=out:json";
let oncekiSayi = 0;

async function yukle() {
  try {
    const res = await fetch(sheetURL);
    const text = await res.text();
    const json = JSON.parse(text.substring(47).slice(0, -2));

    const satirlar = json.table.rows.filter(r => r.c && r.c[0]);

    const tbody = document.getElementById("orders");
    tbody.innerHTML = "";

    satirlar.forEach(r => {
      const tr = document.createElement("tr");
      r.c.forEach(c => {
        const td = document.createElement("td");
        td.textContent = c ? (c.f || c.v) : "";
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });

    if (satirlar.length > oncekiSayi) {
      document.getElementById("alarm").play();
      oncekiSayi = satirlar.length;
    }

  } catch (e) {
    console.error(e);
    document.getElementById("orders").innerHTML =
      "<tr><td colspan='5'>❌ Veri çekilemedi</td></tr>";
  }
}

yukle();
setInterval(yukle, 5000);
</script>



